<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_0fr9mln" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.10.0">
  <bpmn:process id="approbationConges" name="Processus d&#39;approbation des congés" isExecutable="true" camunda:historyTimeToLive="180">
    <bpmn:startEvent id="StartEvent_1" name="Demande initiée">
      <bpmn:outgoing>SequenceFlow_1fp17al</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="SequenceFlow_1fp17al" sourceRef="StartEvent_1" targetRef="soumettreDemandeConges" />
    <bpmn:userTask id="soumettreDemandeConges" name="Soumettre une demande de congés" camunda:formKey="demandeConges" camunda:assignee="${initiator}">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="nom" label="Nom" type="string" />
          <camunda:formField id="prenom" label="Prénom" type="string" />
          <camunda:formField id="dateDebut" label="Date de début" type="date" />
          <camunda:formField id="dateFin" label="Date de fin" type="date" />
          <camunda:formField id="motif" label="Motif du congé" type="string" />
          <camunda:formField id="commentaire" label="Commentaire" type="string" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_1fp17al</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0h21x7r</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="SequenceFlow_0h21x7r" sourceRef="soumettreDemandeConges" targetRef="validateDemande" />
    <bpmn:serviceTask id="validateDemande" name="Valider les données de la demande" camunda:delegateExpression="${dataValidationDelegate}">
      <bpmn:incoming>SequenceFlow_0h21x7r</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_03j02na</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="SequenceFlow_03j02na" sourceRef="validateDemande" targetRef="approuverDemande" />
    <bpmn:userTask id="approuverDemande" name="Approuver la demande" camunda:formKey="approbationConges" camunda:candidateGroups="managers">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="approbation" label="Approuver la demande" type="boolean" />
          <camunda:formField id="commentaireManagerial" label="Commentaire" type="string" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_03j02na</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1axd8hr</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="ExclusiveGateway_0ygumq5" name="Demande approuvée ?">
      <bpmn:incoming>SequenceFlow_1axd8hr</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0wpdn0v</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_0qvl5hi</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="SequenceFlow_1axd8hr" sourceRef="approuverDemande" targetRef="ExclusiveGateway_0ygumq5" />
    <bpmn:sequenceFlow id="SequenceFlow_0wpdn0v" name="Oui" sourceRef="ExclusiveGateway_0ygumq5" targetRef="confirmerConges">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${approbation == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_0qvl5hi" name="Non" sourceRef="ExclusiveGateway_0ygumq5" targetRef="notifierRefus">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${approbation == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:serviceTask id="notifierRefus" name="Notifier le refus" camunda:delegateExpression="${emailNotificationDelegate}">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="emailSubject">Demande de congés refusée</camunda:inputParameter>
          <camunda:inputParameter name="emailContent">Votre demande de congés du ${dateDebut} au ${dateFin} a été refusée avec le commentaire suivant: ${commentaireManagerial}</camunda:inputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0qvl5hi</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_15wj1qp</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="confirmerConges" name="Confirmer les congés" camunda:delegateExpression="${emailNotificationDelegate}">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="emailSubject">Demande de congés approuvée</camunda:inputParameter>
          <camunda:inputParameter name="emailContent">Votre demande de congés du ${dateDebut} au ${dateFin} a été approuvée. Bonnes vacances!</camunda:inputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0wpdn0v</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_01c3od5</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="logConges" name="Journaliser la demande" camunda:delegateExpression="${loggerDelegate}">
      <bpmn:incoming>SequenceFlow_0bfxdc3</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1lbvpwx</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="EndEvent_16egb15" name="Demande traitée">
      <bpmn:incoming>SequenceFlow_1lbvpwx</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="SequenceFlow_1lbvpwx" sourceRef="logConges" targetRef="EndEvent_16egb15" />
    <bpmn:exclusiveGateway id="ExclusiveGateway_11u8wu4">
      <bpmn:incoming>SequenceFlow_01c3od5</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_15wj1qp</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0bfxdc3</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="SequenceFlow_01c3od5" sourceRef="confirmerConges" targetRef="ExclusiveGateway_11u8wu4" />
    <bpmn:sequenceFlow id="SequenceFlow_15wj1qp" sourceRef="notifierRefus" targetRef="ExclusiveGateway_11u8wu4" />
    <bpmn:sequenceFlow id="SequenceFlow_0bfxdc3" sourceRef="ExclusiveGateway_11u8wu4" targetRef="logConges" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="approbationConges">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="179" y="159" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="155" y="202" width="84" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1fp17al_di" bpmnElement="SequenceFlow_1fp17al">
        <di:waypoint x="215" y="177" />
        <di:waypoint x="270" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="UserTask_1t55m6i_di" bpmnElement="soumettreDemandeConges">
        <dc:Bounds x="270" y="137" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0h21x7r_di" bpmnElement="SequenceFlow_0h21x7r">
        <di:waypoint x="370" y="177" />
        <di:waypoint x="430" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_1qgbdxn_di" bpmnElement="validateDemande">
        <dc:Bounds x="430" y="137" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_03j02na_di" bpmnElement="SequenceFlow_03j02na">
        <di:waypoint x="530" y="177" />
        <di:waypoint x="590" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="UserTask_1df11cg_di" bpmnElement="approuverDemande">
        <dc:Bounds x="590" y="137" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_0ygumq5_di" bpmnElement="ExclusiveGateway_0ygumq5" isMarkerVisible="true">
        <dc:Bounds x="745" y="152" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="747" y="209" width="47" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1axd8hr_di" bpmnElement="SequenceFlow_1axd8hr">
        <di:waypoint x="690" y="177" />
        <di:waypoint x="745" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0wpdn0v_di" bpmnElement="SequenceFlow_0wpdn0v">
        <di:waypoint x="770" y="152" />
        <di:waypoint x="770" y="100" />
        <di:waypoint x="850" y="100" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="779" y="123" width="17" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0qvl5hi_di" bpmnElement="SequenceFlow_0qvl5hi">
        <di:waypoint x="770" y="202" />
        <di:waypoint x="770" y="260" />
        <di:waypoint x="850" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="776" y="228" width="19" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_09y81cq_di" bpmnElement="notifierRefus">
        <dc:Bounds x="850" y="220" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_0dqmakd_di" bpmnElement="confirmerConges">
        <dc:Bounds x="850" y="60" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_0bejt48_di" bpmnElement="logConges">
        <dc:Bounds x="1120" y="137" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_16egb15_di" bpmnElement="EndEvent_16egb15">
        <dc:Bounds x="1282" y="159" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1257" y="202" width="87" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1lbvpwx_di" bpmnElement="SequenceFlow_1lbvpwx">
        <di:waypoint x="1220" y="177" />
        <di:waypoint x="1282" y="177" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ExclusiveGateway_11u8wu4_di" bpmnElement="ExclusiveGateway_11u8wu4" isMarkerVisible="true">
        <dc:Bounds x="1005" y="152" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_01c3od5_di" bpmnElement="SequenceFlow_01c3od5">
        <di:waypoint x="950" y="100" />
        <di:waypoint x="1030" y="100" />
        <di:waypoint x="1030" y="152" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_15wj1qp_di" bpmnElement="SequenceFlow_15wj1qp">
        <di:waypoint x="950" y="260" />
        <di:waypoint x="1030" y="260" />
        <di:waypoint x="1030" y="202" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0bfxdc3_di" bpmnElement="SequenceFlow_0bfxdc3">
        <di:waypoint x="1055" y="177" />
        <di:waypoint x="1120" y="177" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
